"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["custom_plugins_zenitPlatformGravity_src_Resources_app_storefront_src_script_plugin_buy-widget-4037d3"],{7439:(t,e,r)=>{r.r(e),r.d(e,{default:()=>l});var s=r(3266),n=r(4049);class i{static serialize(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if("FORM"!==t.nodeName){if(e)throw Error("The passed element is not a form!");return{}}return new FormData(t)}static serializeJson(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1],r=i.serialize(t,e);if(0===Object.keys(r).length)return{};let n={};return s.Z.iterate(r,(t,e)=>n[e]=t),n}}var o=r(3107),a=r(2363);class c extends a.Z{create(){super.create(),this._isButtonElement()?this.parent.disabled=!0:this._isAnchorElement()&&this.parent.classList.add("disabled")}remove(){super.remove(),this._isButtonElement()?this.parent.disabled=!1:this._isAnchorElement()&&this.parent.classList.remove("disabled")}_isButtonElement(){return"button"===this.parent.tagName.toLowerCase()}_isAnchorElement(){return"a"===this.parent.tagName.toLowerCase()}constructor(t,e="before"){if(super(t,e),!this._isButtonElement()&&!this._isAnchorElement())throw Error("Parent element is not of type <button> or <a>")}}class l extends window.PluginBaseClass{init(){if(this._getForm(),!this._form)throw Error("No form found for the plugin: ".concat(this.constructor.name));this._registerEvents(),this._prepareFormRedirect(),this._preventOffcanvas()&&(this.client=new o.Z(window.accessKey,window.contextToken),this.headerCartButton=document.querySelector(".header-cart-btn"),this.buyButton=n.Z.querySelector(this._form,".btn-buy"),this.initialBuyButtonContent=this.buyButton.innerHTML,this.loader=new c(this.buyButton))}_registerEvents(){this.el.addEventListener("submit",this._formSubmit.bind(this))}_formSubmit(t){t.preventDefault();let e=n.Z.getAttribute(this._form,"action"),r=i.serialize(this._form);this.$emitter.publish("beforeFormSubmit"),this._preventOffcanvas()?(this.loader.create(),this.client.post(e.toLowerCase(),r,this._updateCart.bind(this))):this._openOffCanvasCarts(e,r)}_updateCart(t){this.loader.remove(),this._createSuccessIcon(),t&&this.client.get(window.router["frontend.checkout.info"],t=>{this.headerCartButton&&(this.headerCartButton.innerHTML=t)},"text/html")}_prepareFormRedirect(){try{let t=n.Z.querySelector(this._form,this.options.redirectSelector),e=n.Z.querySelector(this._form,this.options.redirectParamSelector);t.value=this.options.redirectTo,e.disabled=!0}catch(t){}}_getForm(){this.el&&"FORM"===this.el.nodeName?this._form=this.el:this._form=this.el.closest("form")}_createSuccessIcon(){this.buyButton.innerHTML="<span class='icon icon-checkmark'><svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' width='24' height='24' viewBox='0 0 24 24'><defs><path id='icons-default-checkmark' d='M2.7071 10.2929c-.3905-.3905-1.0237-.3905-1.4142 0-.3905.3905-.3905 1.0237 0 1.4142l7 7c.3905.3905 1.0237.3905 1.4142 0l13-13c.3905-.3905.3905-1.0237 0-1.4142-.3905-.3905-1.0237-.3905-1.4142 0L9 16.5858l-6.2929-6.293z'></path></defs><use xlink:href='#icons-default-checkmark' fill='#758CA3' fill-rule='evenodd'></use></svg></span>",setTimeout(()=>{this._removeSuccessIcon()},1500)}_removeSuccessIcon(){this.buyButton.hasAttribute("disabled")?this.loader.create():this.buyButton.innerHTML=this.initialBuyButtonContent}_openOffCanvasCarts(t,e){let r=window.PluginManager.getPluginInstances("OffCanvasCart");s.Z.iterate(r,r=>this._openOffCanvasCart(r,t,e))}_openOffCanvasCart(t,e,r){t.openOffCanvas(e,r,()=>{this.$emitter.publish("openOffCanvasCart")})}_preventOffcanvas(){return this.cart=document.querySelector("[data-zen-off-canvas-prevent-on-add-to-cart]")}}l.options={redirectSelector:'[name="redirectTo"]',redirectParamSelector:'[data-redirect-parameters="true"]',redirectTo:"frontend.cart.offcanvas"}},4049:(t,e,r)=>{r.d(e,{Z:()=>n});var s=r(5140);class n{static isNode(t){return"object"==typeof t&&null!==t&&(t===document||t===window||t instanceof Node)}static hasAttribute(t,e){if(!n.isNode(t))throw Error("The element must be a valid HTML Node!");return"function"==typeof t.hasAttribute&&t.hasAttribute(e)}static getAttribute(t,e){let r=!(arguments.length>2)||void 0===arguments[2]||arguments[2];if(r&&!1===n.hasAttribute(t,e))throw Error('The required property "'.concat(e,'" does not exist!'));if("function"!=typeof t.getAttribute){if(r)throw Error("This node doesn't support the getAttribute function!");return}return t.getAttribute(e)}static getDataAttribute(t,e){let r=!(arguments.length>2)||void 0===arguments[2]||arguments[2],i=e.replace(/^data(|-)/,""),o=s.Z.toLowerCamelCase(i,"-");if(!n.isNode(t)){if(r)throw Error("The passed node is not a valid HTML Node!");return}if(void 0===t.dataset){if(r)throw Error("This node doesn't support the dataset attribute!");return}let a=t.dataset[o];if(void 0===a){if(r)throw Error('The required data attribute "'.concat(e,'" does not exist on ').concat(t,"!"));return a}return s.Z.parsePrimitive(a)}static querySelector(t,e){let r=!(arguments.length>2)||void 0===arguments[2]||arguments[2];if(r&&!n.isNode(t))throw Error("The parent node is not a valid HTML Node!");let s=t.querySelector(e)||!1;if(r&&!1===s)throw Error('The required element "'.concat(e,'" does not exist in parent node!'));return s}static querySelectorAll(t,e){let r=!(arguments.length>2)||void 0===arguments[2]||arguments[2];if(r&&!n.isNode(t))throw Error("The parent node is not a valid HTML Node!");let s=t.querySelectorAll(e);if(0===s.length&&(s=!1),r&&!1===s)throw Error('At least one item of "'.concat(e,'" must exist in parent node!'));return s}}},3266:(t,e,r)=>{r.d(e,{Z:()=>s});class s{static iterate(t,e){if(t instanceof Map||Array.isArray(t))return t.forEach(e);if(t instanceof FormData){for(var r of t.entries())e(r[1],r[0]);return}if(t instanceof NodeList)return t.forEach(e);if(t instanceof HTMLCollection)return Array.from(t).forEach(e);if(t instanceof Object)return Object.keys(t).forEach(r=>{e(t[r],r)});throw Error("The element type ".concat(typeof t," is not iterable!"))}}},5140:(t,e,r)=>{r.d(e,{Z:()=>s});class s{static ucFirst(t){return t.charAt(0).toUpperCase()+t.slice(1)}static lcFirst(t){return t.charAt(0).toLowerCase()+t.slice(1)}static toDashCase(t){return t.replace(/([A-Z])/g,"-$1").replace(/^-/,"").toLowerCase()}static toLowerCamelCase(t,e){let r=s.toUpperCamelCase(t,e);return s.lcFirst(r)}static toUpperCamelCase(t,e){return e?t.split(e).map(t=>s.ucFirst(t.toLowerCase())).join(""):s.ucFirst(t.toLowerCase())}static parsePrimitive(t){try{return/^\d+(.|,)\d+$/.test(t)&&(t=t.replace(",",".")),JSON.parse(t)}catch(e){return t.toString()}}}},3107:(t,e,r)=>{r.d(e,{Z:()=>s});class s{get(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"application/json",s=this._createPreparedRequest("GET",t,r);return this._sendRequest(s,null,e)}post(t,e,r){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"application/json";s=this._getContentType(e,s);let n=this._createPreparedRequest("POST",t,s);return this._sendRequest(n,e,r)}delete(t,e,r){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"application/json";s=this._getContentType(e,s);let n=this._createPreparedRequest("DELETE",t,s);return this._sendRequest(n,e,r)}patch(t,e,r){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"application/json";s=this._getContentType(e,s);let n=this._createPreparedRequest("PATCH",t,s);return this._sendRequest(n,e,r)}abort(){if(this._request)return this._request.abort()}setErrorHandlingInternal(t){this._errorHandlingInternal=t}_registerOnLoaded(t,e){e&&(!0===this._errorHandlingInternal?(t.addEventListener("load",()=>{e(t.responseText,t)}),t.addEventListener("abort",()=>{console.warn("the request to ".concat(t.responseURL," was aborted"))}),t.addEventListener("error",()=>{console.warn("the request to ".concat(t.responseURL," failed with status ").concat(t.status))}),t.addEventListener("timeout",()=>{console.warn("the request to ".concat(t.responseURL," timed out"))})):t.addEventListener("loadend",()=>{e(t.responseText,t)}))}_sendRequest(t,e,r){return this._registerOnLoaded(t,r),t.send(e),t}_getContentType(t,e){return t instanceof FormData&&(e=!1),e}_createPreparedRequest(t,e,r){return this._request=new XMLHttpRequest,this._request.open(t,e),this._request.setRequestHeader("X-Requested-With","XMLHttpRequest"),r&&this._request.setRequestHeader("Content-type",r),this._request}constructor(){this._request=null,this._errorHandlingInternal=!1}}},2363:(t,e,r)=>{r.d(e,{Z:()=>o});var s=r(3266);let n="loader",i={BEFORE:"before",INNER:"inner"};class o{create(){if(!this.exists()){if(this.position===i.INNER){this.parent.innerHTML=o.getTemplate();return}this.parent.insertAdjacentHTML(this._getPosition(),o.getTemplate())}}remove(){let t=this.parent.querySelectorAll(".".concat(n));s.Z.iterate(t,t=>t.remove())}exists(){return this.parent.querySelectorAll(".".concat(n)).length>0}_getPosition(){return this.position===i.BEFORE?"afterbegin":"beforeend"}static getTemplate(){return'<div class="'.concat(n,'" role="status">\n                    <span class="').concat("visually-hidden",'">Loading...</span>\n                </div>')}static SELECTOR_CLASS(){return n}constructor(t,e=i.BEFORE){this.parent=t instanceof Element?t:document.body.querySelector(t),this.position=e}}}}]);