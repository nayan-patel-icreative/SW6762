{% block block_zen_gallery_description_buybox %}
    {% set galleryWidthConfig = theme_config('zen-product-gallery-slider-width')|default(7) %}
    {% set buyboxWidthConfig = theme_config('zen-product-gallery-slider-width') ? 12 - theme_config('zen-product-gallery-slider-width') : 5 %}
    {% set productDetailManufacturerPosition = theme_config('zen-product-details-manufacturer-position')|default('default') %}
    {% set productDetailRatingPosition = theme_config('zen-product-details-rating-position')|default('default') %}
    {% set productDetailRatingMode = theme_config('zen-product-details-rating-mode')|default('default') %}

    {% set stickyGallery = (theme_config('zen-product-gallery-sticky') is not null) ? theme_config('zen-product-gallery-sticky') : true %}
    {% set stickyGalleryForced = (theme_config('zen-product-gallery-sticky-forced') is not null) ? theme_config('zen-product-gallery-sticky-forced') : true %}
    {% set stickyBuybox = (theme_config('zen-product-details-buybox-sticky') is not null) ? theme_config('zen-product-details-buybox-sticky') : true %}
    {% set stickyBuyboxForced = (theme_config('zen-product-details-buybox-sticky-forced') is not null) ? theme_config('zen-product-details-buybox-sticky-forced') : true %}
    {% set scroller = (theme_config('zen-product-detail-tabs-mode') is same as ('scroller')) ? true : false %}

    {% if galleryWidthConfig > 6 %}
        {% set columns = 1 %}
    {% else %}
        {% set columns = 2 %}
    {% endif %}

    {% block block_zen_gallery_description_buybox_column_left %}
        {% set element = block.slots.getSlot('left') %}
        {% set config = element.fieldConfig.elements %}

        {# ... @zenit - sticky js options #}
        {% set stickyOptions = {
            forced: stickyGalleryForced,
            checkHeight: (stickyGallery and stickyBuybox) ? false : true
        } %}

        <div class="col-lg-7 col-xl-{{ galleryWidthConfig }} product-detail-media"
            {% if stickyGallery %}
                data-zen-sticky="true"
                data-zen-sticky-options="{{ stickyOptions|json_encode }}"
            {% endif %}
             data-cms-element-id="{{ element.id }}">
            {% block block_zen_gallery_description_buybox_column_left_inner %}
                {% sw_include '@Storefront/storefront/element/cms-element-' ~ element.type ~ '.html.twig' ignore missing
                    with {
                    isProduct: config.sliderItems.value == 'product.media' and config.sliderItems.source == 'mapped',
                    startIndexThumbnails: 1,
                    startIndexSlider: 1,
                    fallbackImageTitle: page.product.translated.name
                } %}
            {% endblock %}
        </div>
    {% endblock %}

    {% block block_zen_gallery_description_buybox_column_right %}
        {% set buyboxElement = block.slots.getSlot('right-top') %}
        {% set totalReviews = buyboxElement.data.totalReviews %}
        {% set descriptionReviewsElement = block.slots.getSlot('right-bottom') %}
        {% set mobileDefaultTabMode = (theme_config('zen-product-detail-tabs-mode-mobile') is same as ('standard')) ? true : false %}

        {# ... @zenit - sticky js options
        it is needed that checkHeight to true again, if stickyGallery
        and stickyBuybox are enabled and the tabs are displayed in buybox
        and tabs mode is set to scroller.
        #}
        {% set stickyOptions = {
            forced: stickyBuyboxForced,
            checkHeight: (stickyGallery and stickyBuybox and not scroller) ? false : true
        } %}

        <div class="col-lg-5 col-xl-{{ buyboxWidthConfig }} product-detail-buy"
             data-cms-element-id="{{ buyboxElement.id }}"
            {% if stickyBuybox %}
                data-zen-sticky="true"
                data-zen-sticky-options="{{ stickyOptions|json_encode }}"
             {% endif %}
        >
            {% block block_zen_gallery_description_buybox_buybox_element %}
                {% block block_zen_gallery_description_buybox_buybox_inner %}
                    {% sw_include '@Storefront/storefront/element/cms-element-' ~ buyboxElement.type ~ '.html.twig' ignore missing with {
                        element: buyboxElement
                    }%}
                {% endblock %}
            {% endblock %}

            {% block block_zen_gallery_description_buybox_product_description_review_element %}
                {% block block_zen_gallery_description_buybox_product_description_review_inner %}
                    {% sw_include '@Storefront/storefront/element/cms-element-' ~ descriptionReviewsElement.type ~ '.html.twig' ignore missing with {
                        element: descriptionReviewsElement
                    }%}
                {% endblock %}
            {% endblock %}
        </div>
    {% endblock %}
{% endblock %}
