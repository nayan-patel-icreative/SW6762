{% sw_extends '@Storefront/storefront/element/cms-element-image-slider.html.twig' %}

{% block element_image_slider %}
    {# TODO: @zenit - Check again as soon as Shopware solves the bug in the original code itself. #}
    {% if not config %}
        {% set config = element.fieldConfig.elements %}
    {% endif %}

    {{ parent() }}
{% endblock %}

{% block element_image_slider_inner %}
    <div class="image-slider-container"
         data-base-slider-container="true">
        {% for image in element.data.sliderItems %}

            {% set imageElement %}
                <div class="image-slider-item{% if loop.first != true %} is-not-first{% endif %} is-{{ sliderConfig.displayMode.value }}"{% if sliderConfig.minHeight.value and sliderConfig.displayMode.value == "cover" %} style="min-height: {{ sliderConfig.minHeight.value|trim|replace({' ':''}) }}"{% endif %}>
                    {% set attributes = {
                        class: 'img-fluid image-slider-image',
                        alt: (image.media.translated.alt|default('')),
                        title: (image.media.translated.title|default(''))
                    } %}

                    {% if element.config.displayMode.value == 'cover' or element.config.displayMode.value == 'contain' %}
                        {% set attributes = attributes|merge({ 'data-object-fit': element.config.displayMode.value }) %}
                    {% endif %}

                    {# ... @zenit - enables lazy loading for images,
                    but only on cover mode, because of JS height calculation #}
                    {% if element.config.displayMode.value == 'cover' %}
                        {% if config('zenitPlatformGravity.config.lazyloading') %}
                            {% set attributes = attributes|merge({ loading: 'lazy' }) %}
                        {% endif %}
                    {% endif %}

                    {% sw_thumbnails 'cms-image-slider-thumbnails' with {
                        media: image.media
                    } %}
                </div>
            {% endset %}

            {{ block('element_image_slider_inner_item') }}
        {% endfor %}
    </div>

    {{ block('element_image_slider_controls') }}
{% endblock %}

{% block element_image_slider_controls_items_arrows %}
    <button
        class="base-slider-controls-prev image-slider-controls-prev{% if sliderConfig.navigationArrows.value == "outside" %} is-nav-prev-outside{% elseif sliderConfig.navigationArrows.value == "inside" %} is-nav-prev-inside{% endif %}"
        aria-label="{{ 'general.previous'|trans|striptags }}"
    >
        {% block element_image_slider_controls_items_prev_icon %}
            {% sw_icon 'arrow-head-left' %}
        {% endblock %}
    </button>
    <button
        class="base-slider-controls-next image-slider-controls-next{% if sliderConfig.navigationArrows.value == "outside" %} is-nav-next-outside{% elseif sliderConfig.navigationArrows.value == "inside" %} is-nav-next-inside{% endif %}"
        aria-label="{{ 'general.next'|trans|striptags }}"
    >
        {% block element_image_slider_controls_items_next_icon %}
            {% sw_icon 'arrow-head-right' %}
        {% endblock %}
    </button>
{% endblock %}
